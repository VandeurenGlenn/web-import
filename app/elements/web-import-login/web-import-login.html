<link rel="import" href="..\..\bower_components/polymer/polymer.html">
<link rel="import" href="..\..\bower_components/firebase-element/firebase-auth.html">
<link rel="import" href="../web-import-dialog/web-import-dialog.html">

<dom-module id="web-import-login">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <firebase-auth location="https://webimport.firebaseio.com" user="{{user}}" provider="[[provider]]" redirect="[[redirect]]"></firebase-auth>
    <web-import-dialog title="login" opened$="[[_computeOpened(user, disabled)]]" with-backdrop>
      <div buttons>
        <paper-button on-tap="googleLogin" raised>google</paper-button>
      </div>
    </web-import-dialog>
  </template>
  <script>
    Polymer({
      is: 'web-import-login',
      properties: {
        user: {
          type: Object,
          notify: true,
          value: null
        },

        redirect: {
          type: Boolean,
          value: false
        },

        disabled: {
          type: Boolean,
          value: false
        },

        params: {
          type: Object,
          value: {scope: 'email'}
        }
      },

      googleLogin: function () {
        this.provider = 'google';
        this.querySelector('firebase-auth').login(this.params);
      },

      _computeOpened: function (user, disabled) {
        if (!user && !disabled) {
          return true;
        }
        return false;
      },

      logout: function () {
        this.querySelector('firebase-auth').logout;
      }
    });
  </script>
</dom-module>
